{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "properties": {
      "@context": {
        "type": "string"
      },
      "id": {
        "type": "string"
      },
      "template_id": {
        "type": "string"
      },
      "version": {
        "type": "string"
      },
      "policyUrl": {
        "type": "string"
      },
      "processing": {
        "type": "object",
        "properties": {
          "methodOfUse": {
            "type": "string"
          },
          "data_retention_period": {
            "type": "integer"
          },
          "jurisdiction": {
            "type": "string"
          },
          "withdrawalUrl": {
            "type": "string"
          },
          "sensitivePii": {
            "type": "array",
            "items": [
              {
                "type": "string"
              }
            ]
          },
          "code_of_conduct": {
            "type": "string"
          },
          "assessmentPerformed": {
            "type": "object",
            "properties": {
              "dpia_conducted": {
                "type": "boolean"
              },
              "dpia_passed": {
                "type": "boolean"
              },
              "dpia_date": {
                "type": "string"
              },
              "dpia_verification_url": {
                "type": "string"
              }
            },
            "required": [
              "dpia_conducted",
              "dpia_passed",
              "dpia_date",
              "dpia_verification_url"
            ]
          }
        },
        "required": [
          "methodOfUse",
          "data_retention_period",
          "jurisdiction",
          "withdrawalUrl",
          "sensitivePii"
        ]
      },
      "record": {
        "type": "object",
        "properties": {
          "dataController": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "url": {
                "type": "string"
              },
              "postal": {
                "type": "string"
              },
              "email": {
                "type": "string"
              },
              "phone": {
                "type": "string"
              }
            },
            "required": [
              "id",
              "url"
            ]
          },
          "dataSubject": {
            "type": "string"
          },
          "timestamp": {
            "type": "string"
          },
          "service": {
            "type": "string"
          },
          "consentDuration": {
            "type": "integer"
          },
          "formOfConsent": {
            "type": "string"
          },
          "terminationTimestamp": {
            "type": "string"
          }
        },
        "required": [
          "dataController",
          "dataSubject",
          "timestamp",
          "service",
          "consentDuration",
          "formOfConsent"
        ]
      },
      "purposes": {
        "type": "array",
        "items": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "purpose": {
                "type": "string"
              },
              "purpose_description": {
                "type": "string"
              },
              "purposeCategory": {
                "type": "string",
                "enum":["Identify verification",
                    "Fraud detection and prevention",
                    "Access control",
                    "Service Provision",
                    "Service Optimization",
                    "Service Personalisation",
                    "Marketing",
                    "Commercial Interests",
                    "Research & Development"]
              }
            },
            "required": [
              "id",
              "purpose",
              "purpose_description",
              "purposeCategory"
            ]
          }
        ]
      },
      "personal_data": {
        "type": "array",
        "items": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "piiCategory": {
                "type": "string"
              },
              "sensitive": {
                "type": "boolean"
              },
              "purposes": {
                "type": "array",
                "items": [
                  {
                    "type": "string"
                  }
                ]
              },
              "transfers": {
                "type": "array",
                "items": [
                  {
                    "type": "object",
                    "properties": {
                      "exchange": {
                        "type": "boolean"
                      },
                      "third_party_name": {
                        "type": "array",
                        "items": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "string"
                          }
                        ]
                      }
                    },
                    "required": [
                      "exchange",
                      "third_party_name"
                    ]
                  }
                ]
              }
            },
            "required": [
              "id",
              "piiCategory",
              "sensitive",
              "purposes",
              "transfers"
            ]
          }
        ]
      },
      "proofChain": {
        "type": "array",
        "items": [
          {
            "type": "object",
            "properties": {
              "type": {
                "type": "string"
              },
              "created": {
                "type": "string"
              },
              "verificationMethod": {
                "type": "string"
              },
              "proofPurpose": {
                "type": "string"
              },
              "jws": {
                "type": "string"
              }
            },
            "required": [
              "type",
              "created",
              "verificationMethod",
              "proofPurpose",
              "jws"
            ]
          }
        ]
      }
    },
    "required": [
      "@context",
      "id",
      "version",
      "policyUrl",
      "processing",
      "record",
      "purposes",
      "personal_data"
    ]
  }